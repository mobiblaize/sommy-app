(window.webpackJsonp=window.webpackJsonp||[]).push([[6],{kahe:function(e,t,n){"use strict";n.r(t),n.d(t,"PostModule",(function(){return x}));var s=n("ofXK"),r=n("tyNb"),o=n("Rpy1"),i=n("tk/3"),l=n("fXoL"),a=n("zM63"),d=n("4XAN"),c=n("sriv"),m=n("3Pt+");function p(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",20),l["\u0275\u0275elementStart"](1,"div",21),l["\u0275\u0275text"](2),l["\u0275\u0275elementStart"](3,"div",22),l["\u0275\u0275elementStart"](4,"button",23),l["\u0275\u0275listener"]("click",(function(){l["\u0275\u0275restoreView"](e);const n=t.index;return l["\u0275\u0275nextContext"]().removeOldFile(n)})),l["\u0275\u0275text"](5,"Remove"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"div",24),l["\u0275\u0275element"](7,"img",25),l["\u0275\u0275element"](8,"br"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,s=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",e," "),l["\u0275\u0275advance"](5),l["\u0275\u0275propertyInterpolate1"]("src","../../../assets/posts/",s.post.images[n],"",l["\u0275\u0275sanitizeUrl"])}}function g(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",20),l["\u0275\u0275elementStart"](1,"div",21),l["\u0275\u0275text"](2),l["\u0275\u0275elementStart"](3,"div",22),l["\u0275\u0275elementStart"](4,"button",23),l["\u0275\u0275listener"]("click",(function(){l["\u0275\u0275restoreView"](e);const n=t.index;return l["\u0275\u0275nextContext"]().removeFile(n)})),l["\u0275\u0275text"](5,"Remove"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"div",24),l["\u0275\u0275element"](7,"img",26),l["\u0275\u0275element"](8,"br"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit,n=t.index,s=l["\u0275\u0275nextContext"]();l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate1"](" ",e.name," "),l["\u0275\u0275advance"](5),l["\u0275\u0275property"]("src",s.images[n],l["\u0275\u0275sanitizeUrl"])}}const u=function(e){return{width:e}};let h=(()=>{class e{constructor(e,t,n,s,r){this.progress=e,this.route=t,this.router=n,this.authService=s,this.flashMessage=r,this.post={title:"",body:"",images:[]},this.multipleImages=[],this.images=[],this.completion=0}ngOnInit(){this.progressRef=this.progress.ref("myProgress"),this.route.paramMap.subscribe(e=>{let t={id:e.get("id")};this.authService.getPost(t).subscribe(e=>{this.post=e.post},e=>{if(console.log(e),e instanceof i.d){if(404!==e.status)return this.flashMessage.show("An error occured try again later",{cssClass:"alert-danger mb-0",timeout:3e3});this.flashMessage.show(e.error.message,{cssClass:"alert-danger mb-0",timeout:3e3}),this.router.navigate(["/admin/posts"])}})})}onSelect(e){if(e.target.files.length>0){for(var t=0,n=e.target.files.length;t<n;t++)this.multipleImages.push(e.target.files[t]);this.images=[],Array.from(this.multipleImages).forEach((e,t)=>{let n=new FileReader;n.readAsDataURL(e),n.onload=e=>{this.images[t]=e.target.result}})}}removeFile(e){this.multipleImages=this.multipleImages.filter((t,n)=>n!==e),this.images.splice(e,1)}removeOldFile(e){this.post.images.splice(e,1)}onSubmit(e){e.disabled=!0,this.progressRef.start(),this.completion=0;const t=new FormData;for(let n of this.multipleImages)t.append("files",n);t.append("id",this.post._id.toString()),t.append("title",this.post.title.toString()),t.append("body",this.post.body.toString());for(let n of this.post.images)t.append("images",n.toString());this.authService.editPost(t).subscribe(t=>{t.type==i.e.UploadProgress?(this.completion=Math.round(t.loaded/t.total*100),console.log("upload progress: "+Math.round(t.loaded/t.total*100)+" %")):t.type==i.e.Response&&(this.flashMessage.show(t.body.message,{cssClass:"alert-success mb-0",timeout:3e3}),this.progressRef.complete(),e.disabled=!1)},t=>{if(console.log(t),this.completion=0,this.progressRef.complete(),e.disabled=!1,t instanceof i.d){if(501===t.status)return this.flashMessage.show(t.error.error.message,{cssClass:"alert-danger mb-0",timeout:3e3});if(404!==t.status)return this.flashMessage.show("An error occured try again later",{cssClass:"alert-danger mb-0",timeout:3e3});this.flashMessage.show(t.error.message,{cssClass:"alert-danger mb-0",timeout:3e3}),this.router.navigate(["/admin"])}})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](a.a),l["\u0275\u0275directiveInject"](r.a),l["\u0275\u0275directiveInject"](r.f),l["\u0275\u0275directiveInject"](d.a),l["\u0275\u0275directiveInject"](c.FlashMessagesService))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-edit-post"]],decls:32,vars:7,consts:[[1,"row","edit-post"],[1,"col-md-2"],[1,"col-md-8"],[1,"row","card"],[1,"col-sm-12"],["routerLink","/admin/posts",1,"btn","btn-lg","btn-link","float-right","nav-link"],["class","row uploadList",4,"ngFor","ngForOf"],["id","fileSelector"],["name","myFiles","id","myFiles","multiple","","type","file",1,"d-none",3,"change"],["chooseFile",""],["type","button",1,"btn","btn-sm","btn-secondary",3,"click"],[1,"form-group","mt-2"],["type","text","name","title","placeholder","Post title",3,"ngModel","ngModelChange"],[1,"form-group"],["name","message","placeholder","Post body","rows","4",3,"ngModel","ngModelChange"],[1,"progress","mb-2"],[1,"progress-bar","bg-success",3,"ngStyle"],[1,"row"],["type","button",1,"btn","btn-primary",3,"click"],["editPost",""],[1,"row","uploadList"],[1,"col-sm-4"],[1,"col-sm-4","pb-2","pt-1"],["type","button",1,"btn","btn-danger",3,"click"],[1,"col-sm-8"],[1,"img-fluid",3,"src"],[1,"img-thumbnail",3,"src"]],template:function(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275element"](1,"div",1),l["\u0275\u0275elementStart"](2,"div",2),l["\u0275\u0275elementStart"](3,"div",3),l["\u0275\u0275elementStart"](4,"div",4),l["\u0275\u0275elementStart"](5,"h4"),l["\u0275\u0275text"](6,"Edit Post"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](7,"button",5),l["\u0275\u0275text"](8,"My Posts"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](9,"div"),l["\u0275\u0275template"](10,p,9,2,"div",6),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](11,"div"),l["\u0275\u0275template"](12,g,9,2,"div",6),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](13,"div",7),l["\u0275\u0275elementStart"](14,"input",8,9),l["\u0275\u0275listener"]("change",(function(e){return t.onSelect(e)})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](16,"button",10),l["\u0275\u0275listener"]("click",(function(){return l["\u0275\u0275restoreView"](e),l["\u0275\u0275reference"](15).click()})),l["\u0275\u0275text"](17,"Add Images"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](18,"div",11),l["\u0275\u0275elementStart"](19,"label"),l["\u0275\u0275text"](20,"Post title"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](21,"input",12),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.post.title=e})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](22,"div",13),l["\u0275\u0275elementStart"](23,"label"),l["\u0275\u0275text"](24,"Body"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](25,"textarea",14),l["\u0275\u0275listener"]("ngModelChange",(function(e){return t.post.body=e})),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](26,"div",15),l["\u0275\u0275element"](27,"div",16),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](28,"div",17),l["\u0275\u0275elementStart"](29,"button",18,19),l["\u0275\u0275listener"]("click",(function(){l["\u0275\u0275restoreView"](e);const n=l["\u0275\u0275reference"](30);return t.onSubmit(n)})),l["\u0275\u0275text"](31,"Update Post"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}2&e&&(l["\u0275\u0275advance"](10),l["\u0275\u0275property"]("ngForOf",t.post.images),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngForOf",t.multipleImages),l["\u0275\u0275advance"](9),l["\u0275\u0275property"]("ngModel",t.post.title),l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngModel",t.post.body),l["\u0275\u0275advance"](2),l["\u0275\u0275property"]("ngStyle",l["\u0275\u0275pureFunction1"](5,u,t.completion+"%")))},directives:[r.g,s.NgForOf,m.b,m.h,m.k,s.NgStyle],styles:[".edit-post[_ngcontent-%COMP%]{background-color:#f4f4f4}.header-section[_ngcontent-%COMP%]{height:80px;line-height:80px;color:beige;background-color:#2e2b2b;font-size:24px;padding-left:20px}.card[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12);color:#000;margin:20px;padding:10px}.uploadList[_ngcontent-%COMP%]{padding:10px;margin-top:10px;margin-bottom:10px}"]}),e})();function f(e,t){if(1&e){const e=l["\u0275\u0275getCurrentView"]();l["\u0275\u0275elementStart"](0,"div",4),l["\u0275\u0275elementStart"](1,"div",5),l["\u0275\u0275elementStart"](2,"h3"),l["\u0275\u0275text"](3),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](4,"p"),l["\u0275\u0275text"](5),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](6,"div",6),l["\u0275\u0275elementStart"](7,"button",7,8),l["\u0275\u0275listener"]("click",(function(){l["\u0275\u0275restoreView"](e);const n=t.$implicit,s=l["\u0275\u0275reference"](8);return l["\u0275\u0275nextContext"]().editPost(n,s)})),l["\u0275\u0275text"](9,"Edit"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementStart"](10,"button",9,10),l["\u0275\u0275listener"]("click",(function(){l["\u0275\u0275restoreView"](e);const n=t.index,s=l["\u0275\u0275reference"](11);return l["\u0275\u0275nextContext"]().deletePost(n,s)})),l["\u0275\u0275text"](12,"Delete"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()}if(2&e){const e=t.$implicit;l["\u0275\u0275advance"](3),l["\u0275\u0275textInterpolate"](e.title),l["\u0275\u0275advance"](2),l["\u0275\u0275textInterpolate"](e.body)}}const b=[{path:"",component:(()=>{class e{constructor(e,t,n,s){this.progress=e,this.authService=t,this.router=n,this.flashMessage=s}ngOnInit(){this.progressRef=this.progress.ref("myProgress"),this.authService.getPosts().subscribe(e=>{this.posts=e.posts},e=>{console.log(e)})}editPost(e,t){t.disabled=!0,this.router.navigate(["/admin/posts",e._id])}deletePost(e,t){let n=this.posts[e];t.disabled=!0,this.progressRef.start(),this.authService.deletePost(n).subscribe(n=>{this.flashMessage.show(n.message,{cssClass:"alert-success",timeout:3e3}),this.posts.splice(e,1),this.progressRef.complete(),t.disabled=!1},e=>{if(console.log(e),this.progressRef.complete(),t.disabled=!1,e instanceof i.d)return 501===e.status?this.flashMessage.show(e.error.message,{cssClass:"alert-danger",timeout:3e3}):this.flashMessage.show(404===e.status?e.error.message:"An error occured try again later",{cssClass:"alert-danger mb-0",timeout:3e3})})}}return e.\u0275fac=function(t){return new(t||e)(l["\u0275\u0275directiveInject"](a.a),l["\u0275\u0275directiveInject"](d.a),l["\u0275\u0275directiveInject"](r.f),l["\u0275\u0275directiveInject"](c.FlashMessagesService))},e.\u0275cmp=l["\u0275\u0275defineComponent"]({type:e,selectors:[["app-posts"]],decls:5,vars:1,consts:[[1,"section-posts"],[1,"container"],[1,"pt-5"],["class","card",4,"ngFor","ngForOf"],[1,"card"],[1,"mt-3"],[1,"row"],[1,"ml-2","float-right","btn","btn-sm","btn-full","btn-primary",3,"click"],["editBtn",""],[1,"ml-2","float-right","btn","btn-sm","btn-full","btn-secondary",3,"click"],["deleteBtn",""]],template:function(e,t){1&e&&(l["\u0275\u0275elementStart"](0,"div",0),l["\u0275\u0275elementStart"](1,"div",1),l["\u0275\u0275elementStart"](2,"h2",2),l["\u0275\u0275text"](3,"My Posts"),l["\u0275\u0275elementEnd"](),l["\u0275\u0275template"](4,f,13,2,"div",3),l["\u0275\u0275elementEnd"](),l["\u0275\u0275elementEnd"]()),2&e&&(l["\u0275\u0275advance"](4),l["\u0275\u0275property"]("ngForOf",t.posts))},directives:[s.NgForOf],styles:[".section-posts[_ngcontent-%COMP%]{min-height:100vh;background-color:#f4f4f4}.header-section[_ngcontent-%COMP%]{height:80px;line-height:80px;color:beige;background-color:#2e2b2b;font-size:24px;padding-left:20px}.card[_ngcontent-%COMP%]{background-color:#fff;box-shadow:0 3px 5px -1px rgba(0,0,0,.2),0 6px 10px 0 rgba(0,0,0,.14),0 1px 18px 0 rgba(0,0,0,.12);color:#000;margin:20px;padding:10px}"]}),e})()},{path:":id",component:h}];let v=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},providers:[o.a],imports:[[r.j.forChild(b)],r.j]}),e})(),x=(()=>{class e{}return e.\u0275mod=l["\u0275\u0275defineNgModule"]({type:e}),e.\u0275inj=l["\u0275\u0275defineInjector"]({factory:function(t){return new(t||e)},imports:[[s.CommonModule,m.g,v]]}),e})()}}]);